<dashboard>
  <label>UF Deployment Tracker</label>
  <description>Monitor status of all Universal Forwarders in your environment</description>
  <row>
    <panel>
      <title>Forwarder Heartbeat Status (Last Seen)</title>
      <table>
        <search>
          <query>
            index=_internal sourcetype="splunkd" component=Metrics 
            | stats latest(_time) as last_seen by host 
            | eval delay = now() - last_seen 
            | eval status = if(delay &lt; 300, "Active", "Inactive") 
            | table host, last_seen, delay, status 
            | sort delay desc
          </query>
        </search>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Deployment Server Check-in</title>
      <table>
        <search>
          <query>
            index=_internal sourcetype="splunkd" component=DeploymentClient 
            | stats latest(_time) as last_contact by host 
            | eval seconds_since = now() - last_contact 
            | eval status = if(seconds_since &lt; 600, "Connected", "Disconnected") 
            | table host, last_contact, seconds_since, status
          </query>
        </search>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Missing Logs from UF (linux_all or win)</title>
      <table>
        <search>
          <query>
            index=linux_all OR index=win 
            earliest=-15m
            | stats latest(_time) as last_log_time by host 
            | eval delay = now() - last_log_time 
            | eval status = if(delay &lt; 900, "OK", "MISSING LOGS") 
            | table host, last_log_time, delay, status
          </query>
        </search>
      </table>
    </panel>
  </row>
</dashboard>

